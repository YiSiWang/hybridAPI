!function(e,n){"object"==typeof exports&&"object"==typeof module?module.exports=n():"function"==typeof define&&define.amd?define([],n):"object"==typeof exports?exports.hybridAPI=n():e.hybridAPI=n()}(this,function(){return function(e){function n(i){if(t[i])return t[i].exports;var r=t[i]={i:i,l:!1,exports:{}};return e[i].call(r.exports,r,r.exports,n),r.l=!0,r.exports}var t={};return n.m=e,n.c=t,n.i=function(e){return e},n.d=function(e,t,i){n.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:i})},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,n){return Object.prototype.hasOwnProperty.call(e,n)},n.p="",n(n.s=5)}([function(e,n,t){"use strict";var i=t(1);t.d(n,"b",function(){return r}),t.d(n,"e",function(){return o}),t.d(n,"a",function(){return a}),t.d(n,"c",function(){return c}),t.d(n,"d",function(){return u});var r=function(e){try{return JSON.parse(e)||{}}catch(e){return!1}},o=function(e){return Object.keys(e).map(function(n){return encodeURIComponent(n)+"="+encodeURIComponent(e[n])}).join("&")},a=function(e){var n=e instanceof Object?Object.prototype.toString.call(e):"";return"[object Function]"===n||"[object GeneratorFunction]"===n},c=function(e){for(var n=[],t=arguments.length-1;t-- >0;)n[t]=arguments[t+1];var r,o=n[n.length-1];o&&o.isReject&&(r=n.pop());var a=window.WebViewJavascriptBridge,c=i.a?"WebViewJavascriptBridgeInjectFinishedReady":"WebViewJavascriptBridgeReady",u=function(){a=window.WebViewJavascriptBridge;try{a.init()}catch(e){}setTimeout(function(){try{window.EJsBridge&&window.EJsBridge[e]?window.EJsBridge[e].apply(window.EJsBridge,n):window.JsBridge&&window.JsBridge[e]?window.JsBridge[e].apply(window.JsBridge,n):a&&a.callHandler.apply(a,[e].concat(n))}catch(e){r&&r(e)}},0)};window.EJsBridge||window.JsBridge||a?u():document.addEventListener(c,u)},u=function(e,n){for(var t=[],i=arguments.length-2;i-- >0;)t[i]=arguments[i+2];n.isReject=!0,c.apply(void 0,[e].concat(t,[n]))}},function(e,n,t){"use strict";t.d(n,"a",function(){return a});var i,r=window.navigator.userAgent;if(/eleme/i.test(r)){var o=r.match(/Eleme\/([0-9]+)\.([0-9]+)/i);i=100*Number(o[1])+Number(o[2])}var a=i<509},function(e,n,t){!function(e,t){t(n)}(0,function(e){"use strict";var n=function(){var e=navigator.userAgent||navigator.vendor;return/windows phone/i.test(e)?"Windows Phone":/android/i.test(e)?"Android":/iPad|iPhone|iPod/.test(e)&&!window.MSStream?"iOS":"Unknown"},t=function(e){var n=document.createEvent("Events");n.initEvent("WebViewJavascriptBridgeReady",!0,!0),n.bridge=e,document.dispatchEvent(n)},i={},r="elmscheme",o="__ELM_QUEUE_MESSAGE__",a="elemejsbridge",c="_handler",u="_interface",s=n(),d={},l=void 0,f=function(){l=document.createElement("iframe"),l.style.display="none","iOS"===s&&(l.src=r+"://"+o),document.documentElement.appendChild(l)},h=1,m=[],p=function(e,n,t){if(n){var c="cb_"+h+++"_"+(new Date).getTime();i[c]=n,e.callbackId=c}m.push(e);var u=JSON.stringify(m);"iOS"===s?l.src=r+"://"+o:(l.src=a+"://return/"+t+"/"+encodeURIComponent(u),m=[])},g=function(){var e=JSON.stringify(m);return m=[],e},v=function(e,n){d[e]=n},w=function(e){return d[e]},b=function(e,n,t){p({handlerName:e,data:n},t,c)},y=function(e,n,t,i){var r={obj:e,method:n};void 0!==t&&null!==t&&(r.data=t),p(r,i,u)},_="_response",E=function(e){var n=JSON.parse(e),t=void 0;if(n.responseId)t=i[n.responseId],"function"==typeof t&&t(n.responseData||n.data),delete i[n.responseId];else{if(n.callbackId){var r=n.callbackId;t=function(e){p({responseId:r,data:e},null,_)}}var o=WebViewJavascriptBridge._messageHandler;n.handlerName&&(o=w(n.handlerName));try{o(n.data,t)}catch(e){"undefined"!=typeof console&&console.log("WebViewJavascriptBridge: WARNING: javascript handler threw.",n,e)}}},B=[],x=function(e){B?B.push(e):E(e)},j=!1,k=function(e){if(j)throw new Error("WebViewJavascriptBridge.init called twice");if(window.WebViewJavascriptBridge&&(window.WebViewJavascriptBridge._messageHandler=e,j=!0,B)){for(var n=0;n<B.length;n++)E(B[n]);B=null}},P=function(e,n){var t=window[e]={},i=function(n){n=n.replace(new RegExp(":","g"),""),t[n]=function(){var t=arguments.length;if(t>2)throw new Error("arguments Error");var i=arguments[0]||null,r=arguments[1]||null;1===t&&"function"==typeof i&&(r=i,i=null),y(e,n,i,r)}};(n||[]).forEach(i)},J=function(){var e=document.createEvent("Events");e.initEvent("WebViewJavascriptBridgeInjectFinishedReady",!0,!0),document.dispatchEvent(e)},I=function(){};I.init=k,I.inject=P,I.injectEvent=J,I.registerHandler=v,I.callHandler=b;var R=n();"iOS"===R?(I._fetchQueue=g,I._handleMessageFromObjC=x):"Android"===R?I._handleMessageFromNative=x:console.warn("Error: "+R+" is not supported."),window.WebViewJavascriptBridge=I,f(),t(I),k(),e.inject=P,e.registerHandler=v,e.callHandler=b,e.callObjectMethod=y,Object.defineProperty(e,"__esModule",{value:!0})})},function(e,n,t){"use strict";var i=t(0);t.d(n,"a",function(){return a}),t.d(n,"b",function(){return c});var r=Object.create(null),o=function(e,n){document[e+"EventListener"](n,r[n],!1)},a=function(e){var n=[];e.forEach(function(e){var t=e.eventName,i=function(){setTimeout(e.action,0)};"function"==typeof r[t]&&o("remove",t),r[t]=i,o("add",t),n.push({title:e.text,eventName:t})}),t.i(i.c)("showRightBarItems",n)},c=function(){t.i(i.c)("removeRightBarItems"),Object.keys(r).forEach(function(e){o("remove",e),delete r[e]})}},function(e,n,t){"use strict";t(0);n.a=function(e){var n=e.eventName,t=e.action,i=e.merchantId,r=e.merchantOrderNo,o=e.xShard;n=n||"NATIVE_PAY_CALLBACk",document.addEventListener(n,function(e){var n={};n.merchantId=e.merchant_id,n.merchantOrderNo=e.merchant_order_no,t(n)},!1);var a="eleme://pay?merchant_id="+i+"&merchant_order_no="+r;o&&(a+="&x_shard="+o),location.href=a}},function(e,n,t){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var i=t(1),r=t(0),o=t(2),a=(t.n(o),t(3)),c=t(4);if(!i.a){var u=["getGlobalGeohash","showShareButton","selectedHongbao","selectHongbao","selectCoupon","getLocateStatus","setTitle","closePage","getUserID","showRightBarItems","removeRightBarItems","shouldShowNewRetailRedBadge","networkType","exitConfirm","checkPackages","openPackage"];o.inject("EJsBridge",u)}n.default={getGlobalGeohash:function(e){var n=i.a?[""]:[];if(!t.i(r.a)(e))return new Promise(function(e,i){n.push(function(n){e(t.i(r.b)(n)||n)});try{r.d.apply(void 0,["getGlobalGeohash",i].concat(n))}catch(e){i(e)}});n.push(function(n){e(t.i(r.b)(n)||n)}),r.c.apply(void 0,["getGlobalGeohash"].concat(n))},share:function(e){if(i.a){var n=["0","1","2"],o=n.map(function(n){return"eleme://share?"+t.i(r.e)({type:n,title:e.title,text:"2"===n?e.weibo||e.text:e.text,url:e.url,image_url:e.image_url})});t.i(r.c)("showShareButton",{weixin_session:o[0],weixin_timeline:o[1],weibo:o[2]})}else document.head.insertAdjacentHTML("afterbegin",'<meta name="eleme-share">\n        <meta name="eleme-share:title" content="'+e.title+'">\n        <meta name="eleme-share:description" content="'+e.text+'">\n        <meta name="eleme-share:image" content="'+e.image_url+'">')},selectHongbao:function(e){t.i(r.c)(i.a?"selectedHongbao":"selectHongbao",e,i.a?function(){}:null)},selectCoupon:function(e){t.i(r.c)("selectCoupon",""+e)},getLocateStatus:function(e){if(!t.i(r.a)(e))return new Promise(function(e,n){try{t.i(r.d)("getLocateStatus",n,function(n){e(n)})}catch(e){n(e)}});t.i(r.c)("getLocateStatus",e)},networkType:function(e){if(!t.i(r.a)(e))return new Promise(function(e,n){try{t.i(r.d)("networkType",n,function(e){resulve(e)})}catch(e){n(e)}});t.i(r.c)("networkType",e)},setTitle:function(e){t.i(r.c)("setTitle",e)},closePage:function(){t.i(r.c)("closePage")},exitConfirm:function(e){t.i(r.c)("exitConfirm",e)},getUserID:function(e){if(!t.i(r.a)(e))return new Promise(function(e,n){try{t.i(r.d)("getUserID",n,function(n){e(n)})}catch(e){n(e)}});t.i(r.c)("getUserID",e)},sharePanel:function(e){var n={weixin:{key:"weixin_session",value:0},weixin_timeline:{key:"weixin_timeline",value:1},weibo:{key:"weibo",value:2},qq:{key:"qq_session",value:4},qzone:{key:"qzone_session",value:5}},i=e.url+(~e.url.indexOf("#")||~e.url.indexOf("?")?"&":"?"),o=e.targets.reduce(function(o,a){return o[n[a].key]="eleme://share?"+t.i(r.e)({type:n[a].value,title:e.title,text:2===n[a].value?e.title+", "+e.text+"。分享链接："+i+"type="+a:e.text,url:i+"type="+a,image_url:e.image_url}),o},{});location.href="eleme://sns_share?source="+e.source+"&"+t.i(r.e)(o)},checkPackages:function(e,n){if(!t.i(r.a)(n))return new Promise(function(n,i){try{t.i(r.d)("checkPackages",e,i,function(e){resulve(e)})}catch(e){i(e)}});t.i(r.c)("checkPackages",e,n)},openPackage:function(e){t.i(r.c)("openPackage",e)},setRightMenu:a.a,clearRightMenu:a.b,shouldShowNewRetailRedBadge:function(e){if(!t.i(r.a)(e))return new Promise(function(e,n){try{t.i(r.d)("shouldShowNewRetailRedBadge",n,function(n){e(n)})}catch(e){n(e)}});t.i(r.c)("shouldShowNewRetailRedBadge",e)},pay:c.a}}])});